# 19110122, Phạm Quốc Thái

# Lab 1: Buffer Overflow

## Task 1: Stack smashing by memory overwritten

## 1.1. bof1.c

First, I installed the program bof1.c into nano.

![alt text](images/image1.1.1.png)

Then I run the command line **"gcc -g bof1.c -o bof1.out -fno-stack-protector -mpreferred-stack-boundary=2"** to compile the program and as shown in the picture there is no error.

![alt text](images/image1.1.2.png)

In order for the program to print the result **"code flow has been modified"** we must find the address of the **"change"** function, so I go to gdb and use the **"disas change" ** command to find the address of the function.

![alt text](images/image1.1.3.png)

We see the function **"secretFunc"** has the address 0x0804846b.

Then I exited gdb and entered the command **"python -c print ‘a’\*204 + \x6b\x84\x04\x08’” | ./bof1.out"** to see the output of the program.

![alt text](images/image1.1.4.png)

Command explanation:

- " python -c "print 'a'\*204 : In this statement I assign the buffer memory area with a value consisting of 204 letters 'a'.
- “+'\x6b\x84\x04\x08'" : In this statement, I add the address of the change function but write the opposite because in the memory area, the low byte is first, the high byte is after. (So '6b' is the lowest byte that should come first, followed in turn ’84’, ’04’, ’08’).

![alt text](images/image1.1.5.png)

Explanation of printing 204 characters a: Because the Buffer occupies 200 memory cells in the memory area + 4 memory cells of the frame pointer.

We observe the results

![alt text](images/image1.1.6.png)

## 1.2. bof2.c

First, I installed the program bof2.c into nano.

![alt text](images/image1.2.1.png)

Then I run the command line **"gcc -g bof2.c -o bof2.out -fno-stack-protector -mpreferred-stack-boundary=2"** to compile the program.

![alt text](images/image1.2.2.png)

In this article the result can have 2 cases:

- Case 1: You are on right way!  

In order for the program to print the result **"You are on right way!"**, I genarate a buffer overflow supported by fgets with 40byte and 4 random bytes.  

I entered the command **"python -c print 'a'\*40 + \x23\x06\x01\x20'" | ./bof2.out"**

![alt text](images/image1.2.3.png)
